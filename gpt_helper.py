import openai
import streamlit as st

# üìò –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é GPT
def explain_with_gpt(user_text):
    """
    –ù–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –¥–æ –º–æ–¥–µ–ª—ñ GPT-4 –∑ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É.

    –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
    - user_text (str): —Ç–µ–∫—Å—Ç —ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ—è—Å–Ω–∏—Ç–∏.

    –í–∏–≤–æ–¥–∏—Ç—å:
    - –ü–æ—è—Å–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –º–æ–≤–æ—é, –∑—Ä–æ–∑—É–º—ñ–ª–æ—é –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
    """
    try:
        # üîê –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–ª—é—á–∞ API –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Streamlit
        openai.api_key = st.secrets["OPENAI_API_KEY"]

        # üì§ –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É –¥–æ GPT
        response = openai.ChatCompletion.create(
            model="gpt-4",
            messages=[
                {
                    "role": "system",
                    "content": "–¢–∏ ‚Äî –∞–Ω–∞–ª—ñ—Ç–∏–∫ –¥–∞–Ω–∏—Ö, —è–∫–∏–π –ø–æ—è—Å–Ω—é—î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—Ä–æ—Å—Ç–æ—é –º–æ–≤–æ—é –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∞–±–æ –ª—é–¥–µ–π –±–µ–∑ —Ç–µ—Ö–Ω—ñ—á–Ω–æ–≥–æ –±–µ–∫–≥—Ä–∞—É–Ω–¥—É."
                },
                {
                    "role": "user",
                    "content": user_text
                }
            ]
        )

        # ‚úÖ –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —É Streamlit
        st.write("üìò GPT –ø–æ—è—Å–Ω–µ–Ω–Ω—è:")
        st.success(response['choices'][0]['message']['content'])

    except Exception as e:
        # ‚ö†Ô∏è –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–∫–∏
        st.error(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –¥–æ OpenAI: {e}")
